#! /bin/sh

aq2rdb () {
    curl -g "http://localhost:8081/aq2rdb?$1"
    echo
}

GetDVTable () {
    curl -g "http://localhost:8081/aq2rdb/GetDVTable?$1"
    echo
}

node aq2rdb.js &		# start service

# sometimes necessary on systems where the HTTP server doesn't start
# fast enough:

# sleep 1s

aq2rdb "&userName=apiuser&password=$password&z=prod&u=Discharge.ft^3/s.Mean@09380000&b=2015-01-01T00%3A00%3A00-07%3A00&e=2015-01-03T00%3A00%3A00-07%3A00"

GetDVTable "&timeSeriesIdentifier=Discharge.ft^3/s.Mean@09380000"

GetDVTable "&shahDoobie=Discharge.ft^3/s.Mean@09380000"

GetDVTable "&timeSeriesIdentifier=Discharge.ft^3/s.Mean@09380000&computed=trued"

GetDVTable "&userName=apiuser&password=not4passwurd&timeSeriesIdentifier=Discharge.ft^3/s.Mean@09380000&computed=true"

GetDVTable "&userName=apiuser&password=$password&environment=prod&timeSeriesIdentifier=Discharge.ft^3/s.Mean@09380000&queryFrom=2015-01-01T00%3A00%3A00-07%3A00&queryTo=2015-01-03T00%3A00%3A00-07%3A00"

kill $!
